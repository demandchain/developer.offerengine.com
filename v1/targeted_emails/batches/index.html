<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=1020, maximum-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <meta http-equiv="imagetoolbar" content="false" />
  <meta name="MSSmartTagsPreventParsing" content="true" />

  <link rel="icon" type="image/x-icon" href="http://media.deem.com/designimages/deemsmb_favicon.ico" />
  <link rel="shortcut icon" type="image/x-icon" href="http://media.deem.com/designimages/deemsmb_favicon.ico" />

  <title>Targeted Emails Batches - OfferEngine API</title>

  <link href="/shared/css/documentation.css" rel="stylesheet" />
  <link href="/shared/css/pygments.css" rel="stylesheet" />
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/3.0/css/font-awesome.css">

  <!--[if lt IE 9]> <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script> <![endif]-->
  <!--[if lte IE 9]> <link href="//netdna.bootstrapcdn.com/font-awesome/2.0/css/font-awesome-ie7.css" rel="stylesheet" /> <![endif]-->
</head>
<body class="api">

<div id="wrapper">
  <header class="row">
    <div class="centered clearfix">
      <h1>
        <a href="http://www.deem.com/developer/"><img src="/shared/images/deem_developers.png" alt="Deem Developers" /></a>
      </h1>
      <nav>
        <ul>
          <li><a href="http://www.deem.com/developer/">Home</a></li>
          <li><a href="/" class="active">Documentation</a></li>
          <li><a href="mailto:support@deem.com">Support</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <article class="row">
    <header class="row">
      <div class="centered clearfix">
        <h1>Deem Offers  API Documentation</h1>
      </div>
    </header>

    <div class="centered clearfix">
      <nav id="side-menu" class="col3">
        <h1>Introduction</h1>
        <ul>
          <li><a href="/">Overview</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/authentication/">Authentication</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/errors/">Errors</a><span class="icon-arrow-right"></span></li>
        </ul>

        <h1>Getting Started</h1>
        <ul>
          <li><a href="/v1/quick_start/">Quick Start</a><span class="icon-arrow-right"></span></li>
        </ul>

        <h1>Core Calls</h1>
        <ul>
          <li><a href="/v1/get_deals/">Get Deals</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/full_purchase/">Execute Purchases</a><span class="icon-arrow-right"></span></li>
        </ul>

        <h1>Additional Calls</h1>
        <ul>
          <li><a href="/v1/adunits/">Ad Units</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/deals/">Deals</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/purchases/">Purchases</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/regions/">Regions</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/regions/deals/">Region Deals</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/users/">Users</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/users/access_tokens/">User Access Tokens</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/users/card_links/">User Card Links</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/users/coupons/">User Coupons</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/users/credit_cards/">User Credit Cards</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/users/purchases/">User Purchases</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/users/saved_deals/">User Saved Deals</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/users/shipping_addresses/">User Shipping Addresses</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/users/subscriptions/">User Subscriptions</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/targeted_emails/batches/">Targeted Emails</a><span class="icon-arrow-right"></span></li>
          <li><a href="/v1/stats/merchants/">Stats</a><span class="icon-arrow-right"></span></li>
        </ul>

        <h1>Reseller Calls</h1>
        <ul>
          <li><a href="/v3/resellers/purchases/">Purchases</a><span class="icon-arrow-right"></span></li>
        </ul>
      </nav>

      <div class="content col9">
        <h1 id="batches">Batches</h1>

<ul>
<li><a href="/v1/targeted_emails/batches/#get-a-batch">Get a batch</a></li>
  <li><a href="/v1/targeted_emails/batches/#create-a-batch">Create a batch</a></li>
  <li><a href="/v1/targeted_emails/batches/#cancel-a-batch">Cancel a batch</a></li>
</ul><h2 id="get-a-batch">Get a batch</h2>
<p>Returns a serialized representation of the batch.</p>

<pre><code>GET /v1/targeted_email/batches/:batch_id
</code></pre>

<h3 id="parameters">Parameters</h3>

<dl>
<dt>api_key</dt>
  <dd>
<em>String</em> Partners API key</dd>
  <dt>deal_id</dt>
  <dd>
<em>String</em> The deal id associated with the batch. Used as a guard to verify that the batch is associated with this deal</dd>
</dl><h3 id="response">Response</h3>

<pre class="headers"><code>Status: 200 OK</code></pre>

<pre class="highlight"><code class="language-javascript"><span class="p">{</span>
  <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"success"</span><span class="p">,</span>
  <span class="s2">"batch"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"send_at"</span><span class="o">:</span> <span class="s2">"2012-06-09T12:00:00Z"</span><span class="p">,</span>
    <span class="s2">"deal_id"</span><span class="o">:</span> <span class="s2">"a-50-for-100-worth-of-dining9d343eaf"</span><span class="p">,</span>
    <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"pending"</span><span class="p">,</span>
    <span class="s2">"user_ids"</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">"3f586cbb"</span>
    <span class="p">],</span>
    <span class="s2">"mode"</span><span class="o">:</span> <span class="s2">"suppress"</span><span class="p">,</span>
    <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"e8f6859a"</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>

<h3 id="response-errors">Response Errors</h3>

<h5 id="dealid">deal_id</h5>
<dl>
<dt>deal_id is absent</dt>
  <dd>“is required”</dd>
  <dt>deal_id is unknown</dt>
  <dd>“unknown deal”</dd>
  <dt>deal does not match batch’s deal</dt>
  <dd>“does not match this batch”</dd>
</dl><h2 id="create-a-batch">Create a batch</h2>
<p>Creates a new targeted email batch. 
Limited to 1000 user ids per request.
Limited to 10 000 scheduled user ids per send_at day.</p>

<pre><code>POST /v1/targeted_email/batches
</code></pre>

<h3 id="parameters-1">Parameters</h3>

<dl>
<dt>api_key</dt>
  <dd>
<em>String</em> Partners api_key</dd>
  <dt>deal_id</dt>
  <dd>
<em>String</em> Deal id that this batch is bound to</dd>
  <dt>user_ids</dt>
  <dd>
<em>Array&lt;String&gt;</em> User ids to include in the batch. Any invalid user id will be dropped and as long as there are valid user ids left, the batch will be created and only the valid user ids will be added to the batch. A user id is invalid if it doesn’t exist, or if that user id is already present in another batch scheduled for the same date as the requested send_at date.</dd>
  <dt>mode</dt>
  <dd>
<em>String (‘suppress’|‘augment’)</em> Either “suppress” to make sure the users are not sent a daily update email on the send_at day, or “augment” to allow sending the daily update to be sent that day.</dd>
  <dt>send_at</dt>
  <dd>
<em>String</em> UTC Time the batch delivery should be scheduled for. Must be after tonight midnight and before tomorrow midnight.</dd>
</dl><h3 id="response-1">Response</h3>

<pre class="headers"><code>Status: 201 Created</code></pre>

<pre class="highlight"><code class="language-javascript"><span class="p">{</span>
  <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"success"</span><span class="p">,</span>
  <span class="s2">"batch"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"send_at"</span><span class="o">:</span> <span class="s2">"2012-06-09T12:00:00Z"</span><span class="p">,</span>
    <span class="s2">"deal_id"</span><span class="o">:</span> <span class="s2">"a-50-for-100-worth-of-dining9d343eaf"</span><span class="p">,</span>
    <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"pending"</span><span class="p">,</span>
    <span class="s2">"user_ids"</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">"3f586cbb"</span>
    <span class="p">],</span>
    <span class="s2">"mode"</span><span class="o">:</span> <span class="s2">"suppress"</span><span class="p">,</span>
    <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"e8f6859a"</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>

<h3 id="response-errors-1">Response Errors</h3>

<h5 id="dealid-1">deal_id</h5>
<dl>
<dt>deal_id is absent</dt>
  <dd>“is required”</dd>
  <dt>deal_id is unknown</dt>
  <dd>“unknown deal”</dd>
  <dt>deal is not in-flight or or approved</dt>
  <dd>“deal’s status must be in-flight or approved”</dd>
</dl><h5 id="sendat">send_at</h5>
<dl>
<dt>send_at is absent</dt>
  <dd>“is required”</dd>
  <dt>send_at is not tomorrow</dt>
  <dd>“must be tomorrow”</dd>
  <dt>send_at is before deal start time</dt>
  <dd>“must be after deal’s start time”</dd>
  <dt>send_at is after deal end time</dt>
  <dd>“must be before deal’s end time”</dd>
</dl><h5 id="userids">user_ids</h5>
<dl>
<dt>is absent</dt>
  <dd>“is required”</dd>
  <dt>all are invalid or do not exist</dt>
  <dd>“are all invalid”</dd>
  <dt>all user_ids already scheduled for that day</dt>
  <dd>“are all already scheduled for that day”</dd>
</dl><h5 id="mode">mode</h5>
<dl>
<dt>is absent</dt>
  <dd>“is required”</dd>
  <dt>is invalid</dt>
  <dd>“must be either (…)”</dd>
</dl><h2 id="cancel-a-batch">Cancel a batch</h2>
<p>Cancels the batch.</p>

<pre><code>DELETE /v1/targeted_email/batches/:batch_id
</code></pre>

<h3 id="parameters-2">Parameters</h3>
<dl>
<dt>api_key</dt>
  <dd>
<em>String</em> Partners API key</dd>
  <dt>batch_id</dt>
  <dd>
<em>String</em> The batch id to cancel</dd>
  <dt>deal_id</dt>
  <dd>
<em>String</em> The deal id associated with the batch. Used as a guard to verify that the batch is associated with this deal.</dd>
</dl><h3 id="response-2">Response</h3>

<pre class="headers"><code>Status: 200 OK</code></pre>

<pre class="highlight"><code class="language-javascript"><span class="p">{</span>
  <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"success"</span><span class="p">,</span>
  <span class="s2">"batch"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"send_at"</span><span class="o">:</span> <span class="s2">"2012-06-09T12:00:00Z"</span><span class="p">,</span>
    <span class="s2">"deal_id"</span><span class="o">:</span> <span class="s2">"a-50-for-100-worth-of-dining9d343eaf"</span><span class="p">,</span>
    <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"cancelled"</span><span class="p">,</span>
    <span class="s2">"user_ids"</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">"3f586cbb"</span>
    <span class="p">],</span>
    <span class="s2">"mode"</span><span class="o">:</span> <span class="s2">"suppress"</span><span class="p">,</span>
    <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"e8f6859a"</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>

<h3 id="response-errors-2">Response Errors</h3>

<h5 id="dealid-2">deal_id</h5>
<dl>
<dt>deal_id is absent</dt>
  <dd>“is required”</dd>
  <dt>deal_id is unknown</dt>
  <dd>“unknown deal”</dd>
  <dt>deal does not match batch’s deal</dt>
  <dd>“does not match this batch”</dd>
</dl><h5 id="batchid">batch_id</h5>
<dl>
<dt>batch is already processed</dt>
  <dd>“is already processed, cannot be cancelled”</dd>
</dl><h2 id="possible-batch-statuses">Possible Batch Statuses</h2>

<dl>
<dt>pending</dt>
  <dd>batch is ready and waiting for the send_at time to deliver its targeted emails.</dd>
  <dt>processed</dt>
  <dd>batch has delivered all of its targeted emails successfully.</dd>
  <dt>failed</dt>
  <dd>batch has delivered all of its targeted emails. One or more emails failed to send.</dd>
  <dt>cancelled</dt>
  <dd>batch was cancelled before its delivery time (send_at time).</dd>
</dl>
      </div>

    </div>

  </article>
</div>


<footer class="row">
  <div class="centered">
      <nav>
        <ul class="left">
          <li><a href="http://www.deem.com/"><img src="http://media.deem.com/designimages/deem_logo.png" alt="Deem" width="59" height="18"></a></li>
          <li><a href="http://www.deem.com/work">Save</a></li>
          <li><a href="http://www.deem.com/merchant">Sell</a></li>
          <li><a href="http://www.deem.com/" target="_blank">Partner</a></li>
          <li><a href="http://blog.deem.com/">Discover</a></li>
          <li><a href="http://www.deem.com/developer">Develop</a></li>
        </ul>

        <ul class="right">
          <li><a href="http://www.deem.com/" target="_blank">About Us</a></li>
          <li><a href="http://www.deem.com/privacy/terms.html" target="_blank">Terms</a></li>
          <li><a href="http://www.deem.com/privacy/global-privacy-statement.html" target="_blank">Privacy</a></li>
          <li><a href="mailto:needhelp@deem">Feedback</a></li>
        </ul>
      </nav>
      <p>&copy; 1999-2013 Rearden Commerce, Inc. All rights reserved.</p>
    </div>
</footer>

<script src="/shared/js/jquery.js"></script>
<script src="/shared/js/documentation.js"></script>
<script src="https://tealium.hs.llnwd.net/o43/utag/rearden/main/prod/utag.js"></script>
</body>
</html>
