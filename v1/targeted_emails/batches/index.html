<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="Content-Language" content="en-us" />
  <meta http-equiv="imagetoolbar" content="false" />
  <meta name="MSSmartTagsPreventParsing" content="true" />
  <title>Targeted Emails Batches - OfferEngine API</title>
  <link href="/css/reset.css" rel="stylesheet" type="text/css" />
  <link href="/css/960.css" rel="stylesheet" type="text/css" />
  <link href="/css/uv_active4d.css" rel="stylesheet" type="text/css" />
  <link href="/shared/css/documentation.css" media="screen" rel="stylesheet" type="text/css">
  <link href="/shared/css/pygments.css" media="screen" rel="stylesheet" type="text/css">
  <script src="/shared/js/jquery.js" type="text/javascript"></script>
  <script src="/shared/js/documentation.js" type="text/javascript"></script>
</head>
<body class="api">

    <div id="header-wrapper">
      <div id="header">
        <div>
          <ul class="nav">
            <li><a href="mailto:support@offerengine.com">Support</a></li>
          </ul>
        </div>
      </div><!-- #header -->
    </div><!-- #header-wrapper -->

    <div id="wrapper">
      <div class="content">
        <h1 id="batches">Batches</h1>

<ul>
<li><a href="/v1/targeted_emails/batches/#get-a-batch">Get a batch</a></li>
  <li><a href="/v1/targeted_emails/batches/#create-a-batch">Create a batch</a></li>
  <li><a href="/v1/targeted_emails/batches/#cancel-a-batch">Cancel a batch</a></li>
</ul><h2 id="get-a-batch">Get a batch</h2>
<p>Returns a serialized representation of the batch.</p>

<pre><code>GET /v1/targeted_email/batches/:batch_id
</code></pre>

<h3 id="parameters">Parameters</h3>

<dl>
<dt>api_key</dt>
  <dd>
<em>String</em> Partners API key</dd>
  <dt>deal_id</dt>
  <dd>
<em>String</em> The deal id associated with the batch. Used as a guard to verify that the batch is associated with this deal</dd>
</dl><h3 id="response">Response</h3>

<pre class="headers"><code>Status: 200 OK</code></pre>

<pre class="highlight"><code class="language-javascript"><span class="p">{</span>
  <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"success"</span><span class="p">,</span>
  <span class="s2">"batch"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"send_at"</span><span class="o">:</span> <span class="s2">"2012-06-09T12:00:00Z"</span><span class="p">,</span>
    <span class="s2">"deal_id"</span><span class="o">:</span> <span class="s2">"a-50-for-100-worth-of-dining9d343eaf"</span><span class="p">,</span>
    <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"pending"</span><span class="p">,</span>
    <span class="s2">"user_ids"</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">"3f586cbb"</span>
    <span class="p">],</span>
    <span class="s2">"mode"</span><span class="o">:</span> <span class="s2">"suppress"</span><span class="p">,</span>
    <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"e8f6859a"</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>

<h3 id="response-errors">Response Errors</h3>

<h5 id="dealid">deal_id</h5>
<dl>
<dt>deal_id is absent</dt>
  <dd>“is required”</dd>
  <dt>deal_id is unknown</dt>
  <dd>“unknown deal”</dd>
  <dt>deal does not match batch’s deal</dt>
  <dd>“does not match this batch”</dd>
</dl><h2 id="create-a-batch">Create a batch</h2>
<p>Creates a new targeted email batch. 
Limited to 1000 user ids per request.
Limited to 10 000 scheduled user ids per send_at day.</p>

<pre><code>POST /v1/targeted_email/batches
</code></pre>

<h3 id="parameters-1">Parameters</h3>

<dl>
<dt>api_key</dt>
  <dd>
<em>String</em> Partners api_key</dd>
  <dt>deal_id</dt>
  <dd>
<em>String</em> Deal id that this batch is bound to</dd>
  <dt>user_ids</dt>
  <dd>
<em>Array&lt;String&gt;</em> User ids to include in the batch. Any invalid user id will be dropped and as long as there are valid user ids left, the batch will be created and only the valid user ids will be added to the batch. A user id is invalid if it doesn’t exist, or if that user id is already present in another batch scheduled for the same date as the requested send_at date.</dd>
  <dt>mode</dt>
  <dd>
<em>String (‘suppress’|‘augment’)</em> Either “suppress” to make sure the users are not sent a daily update email on the send_at day, or “augment” to allow sending the daily update to be sent that day.</dd>
  <dt>send_at</dt>
  <dd>
<em>String</em> UTC Time the batch delivery should be scheduled for. Must be after tonight midnight and before tomorrow midnight.</dd>
</dl><h3 id="response-1">Response</h3>

<pre class="headers"><code>Status: 201 Created</code></pre>

<pre class="highlight"><code class="language-javascript"><span class="p">{</span>
  <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"success"</span><span class="p">,</span>
  <span class="s2">"batch"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"send_at"</span><span class="o">:</span> <span class="s2">"2012-06-09T12:00:00Z"</span><span class="p">,</span>
    <span class="s2">"deal_id"</span><span class="o">:</span> <span class="s2">"a-50-for-100-worth-of-dining9d343eaf"</span><span class="p">,</span>
    <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"pending"</span><span class="p">,</span>
    <span class="s2">"user_ids"</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">"3f586cbb"</span>
    <span class="p">],</span>
    <span class="s2">"mode"</span><span class="o">:</span> <span class="s2">"suppress"</span><span class="p">,</span>
    <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"e8f6859a"</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>

<h3 id="response-errors-1">Response Errors</h3>

<h5 id="dealid-1">deal_id</h5>
<dl>
<dt>deal_id is absent</dt>
  <dd>“is required”</dd>
  <dt>deal_id is unknown</dt>
  <dd>“unknown deal”</dd>
  <dt>deal is not in-flight or or approved</dt>
  <dd>“deal’s status must be in-flight or approved”</dd>
</dl><h5 id="sendat">send_at</h5>
<dl>
<dt>send_at is absent</dt>
  <dd>“is required”</dd>
  <dt>send_at is not tomorrow</dt>
  <dd>“must be tomorrow”</dd>
  <dt>send_at is before deal start time</dt>
  <dd>“must be after deal’s start time”</dd>
  <dt>send_at is after deal end time</dt>
  <dd>“must be before deal’s end time”</dd>
</dl><h5 id="userids">user_ids</h5>
<dl>
<dt>is absent</dt>
  <dd>“is required”</dd>
  <dt>all are invalid or do not exist</dt>
  <dd>“are all invalid”</dd>
  <dt>all user_ids already scheduled for that day</dt>
  <dd>“are all already scheduled for that day”</dd>
</dl><h5 id="mode">mode</h5>
<dl>
<dt>is absent</dt>
  <dd>“is required”</dd>
  <dt>is invalid</dt>
  <dd>“must be either (…)”</dd>
</dl><h2 id="cancel-a-batch">Cancel a batch</h2>
<p>Cancels the batch.</p>

<pre><code>DELETE /v1/targeted_email/batches/:batch_id
</code></pre>

<h3 id="parameters-2">Parameters</h3>
<dl>
<dt>api_key</dt>
  <dd>
<em>String</em> Partners API key</dd>
  <dt>batch_id</dt>
  <dd>
<em>String</em> The batch id to cancel</dd>
  <dt>deal_id</dt>
  <dd>
<em>String</em> The deal id associated with the batch. Used as a guard to verify that the batch is associated with this deal.</dd>
</dl><h3 id="response-2">Response</h3>

<pre class="headers"><code>Status: 200 OK</code></pre>

<pre class="highlight"><code class="language-javascript"><span class="p">{</span>
  <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"success"</span><span class="p">,</span>
  <span class="s2">"batch"</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">"send_at"</span><span class="o">:</span> <span class="s2">"2012-06-09T12:00:00Z"</span><span class="p">,</span>
    <span class="s2">"deal_id"</span><span class="o">:</span> <span class="s2">"a-50-for-100-worth-of-dining9d343eaf"</span><span class="p">,</span>
    <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"cancelled"</span><span class="p">,</span>
    <span class="s2">"user_ids"</span><span class="o">:</span> <span class="p">[</span>
      <span class="s2">"3f586cbb"</span>
    <span class="p">],</span>
    <span class="s2">"mode"</span><span class="o">:</span> <span class="s2">"suppress"</span><span class="p">,</span>
    <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"e8f6859a"</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>

<h3 id="response-errors-2">Response Errors</h3>

<h5 id="dealid-2">deal_id</h5>
<dl>
<dt>deal_id is absent</dt>
  <dd>“is required”</dd>
  <dt>deal_id is unknown</dt>
  <dd>“unknown deal”</dd>
  <dt>deal does not match batch’s deal</dt>
  <dd>“does not match this batch”</dd>
</dl><h5 id="batchid">batch_id</h5>
<dl>
<dt>batch is already processed</dt>
  <dd>“is already processed, cannot be cancelled”</dd>
</dl><h2 id="possible-batch-statuses">Possible Batch Statuses</h2>

<dl>
<dt>pending</dt>
  <dd>batch is ready and waiting for the send_at time to deliver its targeted emails.</dd>
  <dt>processed</dt>
  <dd>batch has delivered all of its targeted emails successfully.</dd>
  <dt>failed</dt>
  <dd>batch has delivered all of its targeted emails. One or more emails failed to send.</dd>
  <dt>cancelled</dt>
  <dd>batch was cancelled before its delivery time (send_at time).</dd>
</dl>
      </div>

      <div id="js-sidebar" class="sidebar-shell">
        <div class="js-toggle-list sidebar-module expandable">
          <ul>
            <li>
              <h3><a href="/">Introduction</a></h3>
            </li>
            <li>
              <h3><a href="/v1/authentication/">Authentication</a></h3>
            </li>
            <li>
              <h3><a href="/v1/get_deals/">Get Deals</a></h3>
            </li>
            <li>
              <h3><a href="/v1/full_purchase/">Execute Purchases</a></h3>
            </li>
            <li>
              <h3><a href="/v1/errors/">Errors</a></h3>
            </li>

            <li>
              <h3>
                <a href="javascript:" class="js-expand-btn collapsed">&nbsp;</a>
                <a href="/v1/advanced/">Additional Requests</a>
              </h3>
              <ul>
                <li><a href="/v1/deals/">Deals</a></li>
                <li><a href="/v1/deals/discussions/">Deal Discussions</a></li>
                <li><a href="/v1/purchases/">Purchases</a></li>
                <li><a href="/v1/sessions/">Sessions</a></li>
                <li><a href="/v1/sessions/leads/">Session Leads</a></li>
                <li><a href="/v1/regions/">Regions</a></li>
                <li><a href="/v1/regions/deals/">Region Deals</a></li>
                <li><a href="/v1/regions/activity/">Region Activity</a></li>
                <li><a href="/v1/users/">Users</a></li>
                <li><a href="/v1/users/access_tokens/">User Access Tokens</a></li>
                <li><a href="/v1/users/card_links/">User Card Links</a></li>
                <li><a href="/v1/users/coupons/">User Coupons</a></li>
                <li><a href="/v1/users/credit_cards/">User Credit Cards</a></li>
                <li><a href="/v1/users/images/">User Images</a></li>
                <li><a href="/v1/users/purchases/">User Purchases</a></li>
                <li><a href="/v1/users/saved_deals/">User Saved Deals</a></li>
                <li><a href="/v1/users/shipping_addresses/">User Shipping Addresses</a></li>
                <li><a href="/v1/users/subscriptions/">User Subscriptions</a></li>
                <li><a href="/v1/targeted_emails/batches/">Targeted Emails</a></li>
                <li><a href="/v1/targeted_emails/batches/">Targeted Email Batches</a></li>
                <li><a href="/v1/stats/merchants/">Stats</a></li>
              </ul>
            </li>

            <!--
            <li>
              <h3><a href="javascript:" class="js-expand-btn collapsed">&nbsp;</a><a href="/v1/stats/merchants/">Stats</a></h3>
              <ul>
                <li><a href="/v1/stats/merchants/">Merchants</a></li>
              </ul>
            </li>
            -->
          </ul>
        </div> <!-- /sidebar-module -->
      </div><!-- /sidebar-shell -->

    </div><!-- #wrapper -->

    <div id="footer" >
      <div class="upper_footer">
        <div class="footer_inner clearfix">

        <!--[if IE]><h4 id="blacktocat_ie">GitHub Links</h4><![endif]-->
        <!--![if !IE]><h4 id="blacktocat">GitHub Links</h4><![endif]-->

        <!--ul class="footer_nav">
          <h4>GitHub</h4>
          <li><a href="https://github.com/about">About</a></li>
          <li><a href="https://github.com/blog">Blog</a></li>
          <li><a href="https://github.com/features">Features</a></li>
          <li><a href="https://github.com/contact">Contact &amp; Support</a></li>
          <li><a href="https://github.com/training">Training</a></li>
          <li><a href="http://status.github.com/">Site Status</a></li>
        </ul>

        <ul class="footer_nav">
          <h4>Tools</h4>
          <li><a href="http://mac.github.com/">GitHub for Mac</a></li>
          <li><a href="http://mobile.github.com/">Issues for iPhone</a></li>
          <li><a href="https://gist.github.com">Gist: Code Snippets</a></li>
          <li><a href="http://enterprise.github.com/">GitHub Enterprise</a></li>
          <li><a href="http://jobs.github.com/">Job Board</a></li>
        </ul>

        <ul class="footer_nav">
          <h4>Extras</h4>
          <li><a href="http://shop.github.com/">GitHub Shop</a></li>
          <li><a href="http://octodex.github.com/">The Octodex</a></li>
        </ul>

        <ul class="footer_nav">
          <h4>Documentation</h4>
          <li><a href="http://help.github.com/">GitHub Help</a></li>
          <li><a href="http://developer.github.com/">Developer API</a></li>
          <li><a href="http://github.github.com/github-flavored-markdown/">GitHub Flavored Markdown</a></li>
          <li><a href="http://pages.github.com/">GitHub Pages</a></li>
        </ul-->

        </div><!-- /.site -->
      </div><!-- /.upper_footer -->

      <div class="lower_footer">
        <div class="footer_inner clearfix">
          <div id="legal">

            <ul id="legal_links">
              <li>Terms of Service</li>
              <li>Privacy</li>
              <li>Security</li>
            </ul>

            <p>&copy; <span id="year">year</span> Rearden Commerce All rights reserved.</p>
          </div><!-- /#legal or /#legal_ie-->

          <!--div class="sponsor">
            <a href="http://www.rackspace.com" class="logo">
              <img src="/shared/images/rackspace_logo.png" alt="Dedicated Server" width="38" height="36">
            </a>
            Powered by the <a href="http://www.rackspace.com ">Dedicated
            Servers</a> and<br/> <a href="http://www.rackspacecloud.com">Cloud
            Computing</a> of Rackspace Hosting<span>&reg;</span>
          </div-->
        </div><!-- /.site -->
      </div><!-- /.lower_footer -->
    </div><!-- /#footer -->

</body>
</html>
